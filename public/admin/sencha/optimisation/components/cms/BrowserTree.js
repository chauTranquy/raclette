Ext.define('TextoCMS.components.cms.BrowserTree',{extend:'Ext.tree.Panel',alias:'widget.browsertree',requires:['TextoCMS.store.medias.BrowserTreeStore'],border:true,baseFolder:null,root:{expanded:true,text:'Gestionnaire de m&eacute;dia',selected:true},rootVisible:false,loadMask:true,initComponent:function(){this.store=Ext.create('TextoCMS.store.medias.BrowserTreeStore');this.store.model.getProxy().setExtraParam('API','Application_Model_FileManager');this.store.model.getProxy().setExtraParam('APICall','getFolderList');this.store.model.getProxy().setExtraParam('baseFolder',this.baseFolder);this.store.model.getProxy().setExtraParam('id_site',TextoCMS.siteId);this.callParent(arguments);this.store.on('beforeload',function(tree,op){op.params.root=op.node.get('path');this.setLoading('Chargement en cours')}.bind(this));this.on('afterrender',function(){if(this.store.isLoading())this.setLoading('Chargement en cours')}.bind(this));this.store.on('load',Ext.bind(this.afterLoad,this))},afterLoad:function(){this.setLoading(false);if(this.store.getRootNode().firstChild&&this.store.getRootNode().firstChild.childNodes.length>0)this.store.getRootNode().firstChild.expand()}});